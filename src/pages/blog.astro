---
import '../styles/global.css';

import BaseLayout from '../layouts/BaseLayout.astro';
import BlogPost from '../components/BlogPost.astro';
// import Rightsideber from '../components/Rightsideber.astro';
const pageTitle = "我的博客";
const allPosts = await Astro.glob('./posts/*.md');
const blogs = await Astro.glob('./blogs/*.md');

// const response = await fetch('https://bejamas-website-git-fix-api-cors-issue-bejamas.vercel.app/api/blog/?category=case-studies');
// const data = await response.json();
// const posts = data.posts;
// const response = await fetch('../scripts/data.js');
// const data = await response.json();
---

<BaseLayout pageTitle={pageTitle}>
  <span >
    <p>在这里，我将分享我的学习 Astro 之旅。使用了BaseLayout。
      <br>
      Blog List:
    </p>
    <section class="section blog-section" id="blog-section">
      <div class="container">
        <h2 class="section-title">Our Blog</h2>
        <ul class="blogs">
          {blogs.map((blog) =>
            <li>
              <article class="blog">          
                <img src={blog.frontmatter.image.url} alt="blog.frontmatter.image.alt" />
                <h3>{blog.frontmatter.title}</h3>
                <p>{blog.frontmatter.description}</p>
                <a href={blog.url} class="">Read more</a>
              </article>            
            </li>
          )}
        </ul>
      </div>
    </section>
    
    <ul>
      {allPosts.map((post) =><BlogPost url={post.url} title={post.frontmatter.title}/>)}
    </ul>
    
  </span>
  <slot />
</BaseLayout>