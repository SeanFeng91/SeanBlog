---
import "../styles/global.css";
import IndexLayout from '../layouts/IndexLayout.astro';
import Greeting from '../components/Greeting';

const allPosts = await Astro.glob('../pages/posts/*.md');
const allFiles = await Astro.glob('../pages/**/*.md');
import BlogPost from '../components/BlogPost.astro';

const achieved = await Astro.glob('../pages/posts/03Achieved.md');
const problems = await Astro.glob('../pages/posts/02ProblemsAndAims.md');
const posts = allFiles.filter(file => file.url.includes('/posts/'));
const blogs = allFiles.filter(file => file.url.includes('/blogs/'));

// const { frontmatter } = Astro.props;
const pageTitle = "SeanBlog";

---

<IndexLayout pageTitle={pageTitle}>
	<span slot="maindiv" class="dark:bg-neutral-800">
		<h1 class="font-bold text-8lx text-center">This is My awesome blog with Astro&Tailwind</h2>
		<h2 class="text-center">		
			<Greeting client:load messages={["Hej", "Hallo", "Hola", "Habari"]}/>
		</h2>
		<!-- Now Working on:模块 -->
		<div class="p-4 flex-wrap mb-10 mt-10 grid grid-cols-1 lg:grid-cols-2 gap-4 auto-cols-max text-base ">
			<div class="p-2 border-spacing-2 outline-dotted outline-offset-2 rounded-md outline-slate-300 w-auto bg-slate-50 dark:bg-neutral-500 dark:text-slate-200 min-h-10">
				<h3 class="mt-1 pl-4 dark:text-slate-200">Now Working on:</h3>
				<div class="overflow-auto 
				[&::-webkit-scrollbar]:w-2
				[&::-webkit-scrollbar-track]:rounded-full
				[&::-webkit-scrollbar-track]:bg-gray-100 
				[&::-webkit-scrollbar-thumb]:rounded-full
				[&::-webkit-scrollbar-thumb]:bg-gray-300
				dark:[&::-webkit-scrollbar-track]:bg-neutral-700
				dark:[&::-webkit-scrollbar-thumb]:bg-neutral-500
				max-h-40">
					{problems.map((post, index) => {
						const headings = post.getHeadings();
						return headings.map((heading, headingIndex) => (
						<div class="flex items-center space-x-2 rounded p-2 hover:bg-gray-100">
							<input type="checkbox" id="{headingIndex+1}" name="{headingIndex+1}" data-id={headingIndex+1} class="h-4 w-4 rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 focus:ring-offset-0 disabled:cursor-not-allowed disabled:text-gray-400" />
						  	<label for="{headingIndex+1}" class="flex w-full space-x-2 text-sm">{headingIndex+1}. {heading.text}</label>
						</div>
						));
					  })}


				</div>
			</div>
			<!-- What I have Got:模块 -->
			<div class="max-h-60 border-spacing-2 outline-dotted outline-offset-2 rounded-md outline-slate-300 w-auto p-2 bg-slate-50 min-h-10 dark:bg-neutral-500 dark:text-slate-200">
				<h3 class="mt-1 pl-4 space-y-3 dark:text-slate-200">What I have Got:</h3>
				<div class="overflow-auto
				[&::-webkit-scrollbar]:w-2
				[&::-webkit-scrollbar-track]:rounded-full
				[&::-webkit-scrollbar-track]:bg-gray-100
				[&::-webkit-scrollbar-thumb]:rounded-full
				[&::-webkit-scrollbar-thumb]:bg-gray-300
				dark:[&::-webkit-scrollbar-track]:bg-neutral-700
				dark:[&::-webkit-scrollbar-thumb]:bg-neutral-500
				 max-h-40 text-base">
					{achieved.map((post, index) => {
						const headings = post.getHeadings();
						return headings.map((heading, headingIndex) => (
						  <p class="text-sm space-x-2">{headingIndex+1}. {heading.text}</p>
						));
					  })}
				</div>
				
			</div>
		</div>
		<!-- 首页Cards功能模块 -->
		<div class="p-4 flex-wrap grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 auto-cols-max auto-rows-max dark:bg-neutral-800 dark:text-slate-400">
			{allPosts.map((indexcard,index)=><div class=" min-w-sm border rounded-lg p-4 min-h-60 bg-white dark:bg-neutral-100 shadow-sm ">
				<h4 class="mt-1 mb-0 font-bold light text-gray-400 dark:text-slate-200">Blog No.{index + 1}</h4>
				<h2 class="nav-links mt-1 text-2xl font-bold hover:text-blue-900 ">
					<a href={indexcard.url}>{indexcard.frontmatter.title}</a>
				</h2>
				<p class="text-sm italic tracking-normal">
					{indexcard.frontmatter.description}
				</p>
				</div>)}			
		</div>
		<!-- 滑动条分割 -->
		<!-- <div class="m-10 py-3 flex items-center text-sm text-gray-800 before:flex-1 before:border-t before:border-gray-200 before:me-6 after:flex-1 after:border-t after:border-gray-200 after:ms-6 dark:text-white dark:before:border-neutral-600 dark:after:border-neutral-600">
			Blogs about LLm blow
		</div> -->
		<div class="h-2 rounded-lg bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 ..."></div>

		<!-- 尝试新卡片组件 -->
		<div class="grid grid-flow-row auto-rows-max">
			{blogs.map((indexcard,index)=><div class="bg-white border rounded-xl shadow-sm sm:flex mt-6 p-4 dark:bg-neutral-100 dark:border-neutral-700 dark:shadow-neutral-700/70">
				<div class="shrink-0 relative w-full rounded-t-xl overflow-hidden  sm:rounded-s-xl sm:max-w-60 md:rounded-se-none md:max-w-xs">
				  <img class="size-3/4 absolute items-center ml-6 rounded-lg top-0 start-0 object-cover" src="https://images.unsplash.com/photo-1680868543815-b8666dba60f7?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=560&q=80" alt="Card Image">
				</div>
				<div class="flex flex-wrap">
				  <div class="p-4 flex flex-col h-auto sm:p-4">
					<h3 class="text-lg font-bold text-gray-800 dark:text-white">
						<a href={indexcard.url}>{indexcard.frontmatter.title}</a>
					</h3>
					<p class="mt-1 text-gray-500 dark:text-neutral-400">
						{indexcard.frontmatter.description}
					</p>
					<div class="mt-5 sm:mt-auto">
					  <p class="text-xs text-gray-500 dark:text-neutral-500">
						{indexcard.frontmatter.pubDate}
					  </p>
					</div>
				  </div>
				</div>
			  </div>
			  )}
		</div>

		
	</span>
	<style>
		a {
		  text-decoration: none; /* 取消下划线 */
		}
		Headingsofblog {
			text-decoration: none; /* 取消下划线 */
		}
		
	</style>
	<script>
		// 获取所有复选框
		const checkboxes = document.querySelectorAll('input[type="checkbox"]');
	
		// 初始化复选框状态
		checkboxes.forEach(checkbox => {
		  // 明确声明checkbox的类型
		  const inputElement = checkbox as HTMLInputElement;
		  const id = inputElement.getAttribute('data-id');
		  const savedCheckedState = localStorage.getItem(`checkbox-${id}-checked`);
		  const label = document.querySelector(`label[for="${id}"]`);
	
		  if (savedCheckedState === 'true') {
			inputElement.checked = true;
			label?.classList.add('checked-label');
		  }
	
		  // 添加复选框状态改变的事件监听器
		  inputElement.addEventListener('change', function() {
			if (inputElement.checked) {
			  label?.classList.add('checked-label');
			  localStorage.setItem(`checkbox-${id}-checked`, 'true');
			} else {
			  label?.classList.remove('checked-label');
			  localStorage.setItem(`checkbox-${id}-checked`, 'false');
			}
		  });
		});
	  </script>
</IndexLayout>

